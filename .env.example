# =============================================================================
# EZSTT Configuration
# Copy this file to .env and fill in your values
# =============================================================================

# -----------------------------------------------------------------------------
# Core Settings
# -----------------------------------------------------------------------------
EZSTT_PORT=8767
EZSTT_HOST=127.0.0.1          # Use 0.0.0.0 to expose externally
EZSTT_SR=16000
EZSTT_FRAME_MS=20
EZSTT_LANG=en

# -----------------------------------------------------------------------------
# STT Backend Selection
# -----------------------------------------------------------------------------
EZSTT_BACKEND=whisper         # whisper | openai

# -----------------------------------------------------------------------------
# Local Whisper Backend (EZSTT_BACKEND=whisper)
# -----------------------------------------------------------------------------
# Required: Path to local faster-whisper model directory
# Download from: https://huggingface.co/Systran/faster-whisper-medium
EZSTT_MODEL_DIR=</path/to/whisper/model>
EZSTT_MODEL=medium
EZSTT_DEVICE=auto             # cuda | cpu | auto
EZSTT_COMPUTE_TYPE=auto       # auto â†’ float16 on cuda, int8 on cpu
EZSTT_CPU_THREADS=6
EZSTT_BEAM_SIZE=1
EZSTT_BEST_OF=1
EZSTT_PAD_SHORT_MS=450
EZSTT_MAX_UTTER_MS=60000

# -----------------------------------------------------------------------------
# OpenAI Backend (EZSTT_BACKEND=openai)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=sk-...         # Your OpenAI API key
OPENAI_MODEL=whisper-1        # whisper-1 | gpt-4o-transcribe

# -----------------------------------------------------------------------------
# Speech Endpoint Detection (VAD)
# -----------------------------------------------------------------------------
EZSTT_MIN_SPEECH_MS=120
EZSTT_END_SILENCE_MS=250
EZSTT_PREROLL_MS=120
EZSTT_VAD_SENSITIVITY=2       # 0-3, higher = more aggressive

# -----------------------------------------------------------------------------
# Keyword Spotter (Optional)
# -----------------------------------------------------------------------------
EZSTT_KWS_ENABLE=0
EZSTT_KWS_MIN_MS=120
EZSTT_KWS_MAX_MS=500
EZSTT_KWS_CONF_MIN=0.70
EZSTT_KWS_MODEL_DIR=</path/to/vosk/model>
EZSTT_KWS_GRAMMAR_FILE=resources/kws/en.commands.json

# -----------------------------------------------------------------------------
# Partial Transcripts (Real-time updates)
# -----------------------------------------------------------------------------
EZSTT_PARTIALS_ENABLE=1
EZSTT_PARTIAL_INTERVAL_MS=300
EZSTT_PARTIAL_WINDOW_MS=800
EZSTT_PARTIAL_MIN_MS=220
EZSTT_PARTIAL_MAX_CHARS=160
EZSTT_PARTIAL_REQUIRE_CHANGE=1
EZSTT_PARTIAL_LOW_CONFIDENCE_FLOOR=0.2

# -----------------------------------------------------------------------------
# WebSocket Server
# -----------------------------------------------------------------------------
EZSTT_WS_MAX_MSG_BYTES=2097152    # 2 MB
EZSTT_SESSION_IDLE_TIMEOUT_MS=5000
EZSTT_HEARTBEAT_INTERVAL_MS=10000
EZSTT_RECV_QUEUE_FRAMES=200
EZSTT_RECV_DROP_POLICY=oldest
EZSTT_OUTBOX_MAX_EVENTS=100
# EZSTT_AUTH_TOKEN=             # Optional: require Bearer token
EZSTT_ACCEPT_JSON_AUDIO=1
EZSTT_LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Discord Client (Optional - for Discord integration)
# -----------------------------------------------------------------------------
DISCORD_TOKEN=your-bot-token
GUILD_ID=...
VOICE_CHANNEL_ID=...
TRANSCRIPT_CHANNEL_ID=...
FINALS_TRANSCRIPT_CHANNEL_ID=...
EZSTT_WS_URL=ws://127.0.0.1:8767/ws
PARTIALS_ENABLE=1

# -----------------------------------------------------------------------------
# STT Event Forwarder (Optional)
# -----------------------------------------------------------------------------
FORWARD_WS_PORT=9003
FORWARD_WS_HOST=0.0.0.0
FORWARD_ONLY_FINALS=1

# -----------------------------------------------------------------------------
# TTS Player (Optional - built into discord_stream.ts)
# -----------------------------------------------------------------------------
TTS_PLAYER_PORT=5057

# -----------------------------------------------------------------------------
# Testing
# -----------------------------------------------------------------------------
EZSTT_RUN_SLOW_TESTS=0
